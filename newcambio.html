<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Airconekta ¬∑ Solicitar Cambio</title>
  <meta name="theme-color" content="#ffffff" />
  <meta name="color-scheme" content="light">
  <meta name="description" content="Formulario para solicitar cambio de domicilio de servicio y enviar datos v√≠a WhatsApp.">
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 256 256'%3E%3Crect width='256' height='256' rx='56' fill='%23ffffff'/%3E%3Cpath fill='%23246bff' d='M192 76a8 8 0 0 1 8 8v88a8 8 0 0 1-8 8H64a8 8 0 0 1-8-8V84a8 8 0 0 1 8-8h128zm-16 24H80v72h96V100zM92 72h72a4 4 0 0 1 0 8H92a4 4 0 1 1 0-8z'/%3E%3C/svg%3E" />

  <!--
    ===========================================================
    Firma / Autor (solo visible al depurar o ver c√≥digo fuente)
    Jair Elizondo
    +52 322 243 9782
    Hint: /#whoami
    ===========================================================
  -->

  <style>
    :root{
      --bg: #ffffff;
      --bg-2: #ffffff;
      --ink: #0f1a2e;
      --muted: #5b6b86;
      --accent: #246bff;
      --border: #cfe0ff;
      --radius: 18px;
      --shadow: 0 10px 26px rgba(16,48,96,.10);
    }

    *{ box-sizing: border-box; }
    html,body{ height:100%; margin:0; background:#fff; color:var(--ink); font:16px/1.4 system-ui; }
    .shell{ max-width:920px; margin:0 auto; padding:24px; }

    .nav{
      display:flex; align-items:center; justify-content:space-between;
      padding:16px 18px; border-radius:var(--radius);
      background:var(--bg-2); border:1px solid var(--border); box-shadow:var(--shadow);
      position:sticky; top:12px;
      z-index:10;
    }

    .brand{ display:flex; gap:12px; align-items:center; font-weight:800; }
    .brand .logo{ width:36px; height:36px; border-radius:12px; display:grid; place-items:center; background:#fff; border:1px solid var(--border); color:var(--accent); }
    .brand .logo span{ font-size:18px; }

    .card{
      margin-top:24px; padding:22px; border-radius:22px;
      background:var(--bg-2); border:1px solid var(--border); box-shadow:var(--shadow);
    }

    form{ display:grid; grid-template-columns:repeat(12,1fr); gap:14px; }
    .col-12{ grid-column:span 12; }
    .col-6{ grid-column:span 6; }

    @media (max-width:860px){ .col-6{ grid-column:span 12; } }

    input,textarea,select{
      width:100%; padding:12px 14px; border-radius:14px;
      border:1px solid var(--border); background:#fff;
      font-size:1rem; outline:none;
    }
    input:focus,textarea:focus,select:focus{
      border-color:var(--accent);
      box-shadow:0 0 0 3px rgba(36,107,255,.12);
    }

    label{ font-size:.92rem; margin-bottom:6px; color:var(--muted); }

    .btn{
      border:1px solid var(--accent); color:var(--accent);
      padding:12px 16px; border-radius:14px; font-weight:700;
      background:#fff; cursor:pointer;
    }
    .btn-primary{
      background:var(--accent); color:#fff; border-color:var(--accent);
    }

    .toast{
      position:fixed; bottom:24px; left:50%; transform:translateX(-50%) translateY(20px);
      background:#fff; border:1px solid var(--accent); padding:10px 14px;
      border-radius:12px; opacity:0; pointer-events:none; transition:.2s ease;
      z-index:20;
    }
    .toast.show{ opacity:1; transform:translateX(-50%) translateY(0); }

    .footer{ margin-top:20px; color:var(--muted); display:flex; justify-content:space-between; }

    /* ========================= Splash Screen (Airconekta) ========================= */
    .splash{
      position:fixed;
      inset:0;
      display:grid;
      place-items:center;
      background:
        radial-gradient(900px 520px at 20% 15%, rgba(36,107,255,.22), transparent 60%),
        radial-gradient(900px 520px at 85% 25%, rgba(24,198,255,.16), transparent 55%),
        radial-gradient(900px 520px at 45% 100%, rgba(124,58,237,.12), transparent 60%),
        linear-gradient(180deg, #f7f9ff, #ffffff);
      z-index:9999;
      transition: opacity .35s ease, transform .35s ease, visibility .35s ease;
    }
    .splash.hide{
      opacity:0;
      transform: translateY(-6px);
      visibility:hidden;
      pointer-events:none;
    }
    .splash-card{
      width:min(92vw, 560px);
      border-radius: 28px;
      padding: 26px 22px;
      text-align:center;
      color: var(--ink);
      border: 1px solid rgba(207,224,255,.85);
      background: rgba(255,255,255,.85);
      box-shadow: 0 30px 90px rgba(16,48,96,.18);
      backdrop-filter: blur(14px) saturate(120%);
    }
    .splash-logo{
      width: 88px;
      height: 88px;
      margin: 0 auto 10px;
      border-radius: 26px;
      display:grid;
      place-items:center;
      background: rgba(36,107,255,.06);
      border: 1px solid rgba(36,107,255,.16);
      position:relative;
      overflow:hidden;
    }
    .splash-logo::before{
      content:"";
      position:absolute;
      inset:-40%;
      background: conic-gradient(
        from 0deg,
        rgba(36,107,255,.0),
        rgba(36,107,255,.55),
        rgba(24,198,255,.50),
        rgba(124,58,237,.45),
        rgba(36,107,255,.0)
      );
      animation: spin 2.6s linear infinite;
      opacity:.85;
    }
    .splash-logo .logo-img{
      position:relative;
      width: 62px;
      height: 62px;
      border-radius: 22px;
      display:block;
      background: rgba(255,255,255,.95);
      border:1px solid rgba(207,224,255,.85);
      object-fit: contain;
      padding: 10px;
    }
    .splash-title{
      font-weight: 1000;
      letter-spacing: .6px;
      font-size: clamp(2.0rem, 4.2vw, 3.0rem);
      margin: 8px 0 6px;
    }
    .splash-sub{
      margin: 0;
      color: rgba(91,107,134,.9);
      font-weight: 700;
    }
    .splash-bar{
      height: 10px;
      margin: 16px auto 0;
      border-radius: 999px;
      width: min(380px, 82%);
      background: rgba(36,107,255,.08);
      border: 1px solid rgba(36,107,255,.12);
      overflow:hidden;
    }
    .splash-bar > i{
      display:block;
      height:100%;
      width: 40%;
      background: linear-gradient(90deg, rgba(36,107,255,.15), rgba(36,107,255,.85), rgba(24,198,255,.85));
      border-radius: 999px;
      animation: load 1.1s ease-in-out infinite;
      filter: drop-shadow(0 6px 14px rgba(36,107,255,.18));
    }
    @keyframes load{
      0%{ transform: translateX(-30%); opacity:.65; }
      50%{ transform: translateX(120%); opacity:1; }
      100%{ transform: translateX(260%); opacity:.65; }
    }
    @keyframes spin{ to{ transform: rotate(360deg);} }

    @media (prefers-reduced-motion: reduce){
      .splash-logo::before, .splash-bar > i{ animation:none !important; }
      .splash{ transition:none; }
    }

    /* ========================= WHOAMI (vista oculta por hash) ========================= */
    .who-wrap{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:14px;
      margin-top:12px;
      align-items:stretch;
    }
    @media (max-width:860px){
      .who-wrap{ grid-template-columns:1fr; }
    }
    .who-card{
      border:1px solid var(--border);
      border-radius: 22px;
      padding:16px;
      background: #fff;
      box-shadow: var(--shadow);
    }
    .who-hero{
      display:flex;
      gap:14px;
      align-items:center;
      flex-wrap:wrap;
    }
    .who-avatar{
      width:72px;
      height:72px;
      border-radius: 22px;
      border:1px solid var(--border);
      background:
        radial-gradient(60px 60px at 30% 20%, rgba(36,107,255,.18), transparent 60%),
        radial-gradient(60px 60px at 90% 30%, rgba(24,198,255,.12), transparent 55%),
        radial-gradient(60px 60px at 40% 95%, rgba(124,58,237,.10), transparent 60%),
        rgba(255,255,255,.9);
      display:grid;
      place-items:center;
      font-weight:1000;
      letter-spacing:.6px;
    }
    .who-name{ font-size:1.25rem; margin:0; font-weight:1000; }
    .who-role{ margin:2px 0 0; color:var(--muted); font-weight:800; }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:.9rem;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: #fff;
      color:var(--muted);
    }
    .divider{ height:1px; background: rgba(207,224,255,.8); margin:14px 0; }
    .status{ font-size:.92rem; color:var(--muted); }

    /* Views */
    [data-view]{ display:none; }
    [data-view].active{ display:block; }
  </style>
</head>

<body>
  <!-- Splash -->
  <div class="splash" id="splash" aria-label="Cargando Airconekta">
    <div class="splash-card" role="status" aria-live="polite">
      <div class="splash-logo" aria-hidden="true">
        <img
          class="logo-img"
          alt=""
          src="https://raw.githubusercontent.com/airconekta/airconekta/refs/heads/main/airconekta_logo_transparent.png"
        />
      </div>
      <div class="splash-title">AIRCONEKTA</div>
      <p class="splash-sub">Cambio de domicilio ¬∑ Atenci√≥n local</p>
      <div class="splash-bar" aria-hidden="true"><i></i></div>
    </div>
  </div>

  <div class="shell">

    <nav class="nav">
      <div class="brand">
        <div class="logo"><span>‚ö°</span></div>
        <div>Airconekta <span style="opacity:.65;font-weight:600">Cambio</span></div>
      </div>
      <button id="installBtn" class="btn" style="display:none">‚ûï Instalar</button>
    </nav>

    <!-- ===== VIEW: FORM (default) ===== -->
    <section class="card active" data-view="form" id="viewForm">
      <h1>Solicitar cambio de domicilio</h1>
      <p class="lead">Llena los datos y al finalizar se abrir√° WhatsApp.</p>

      <form id="form" novalidate>

        <div class="col-12">
          <label>Nombre completo</label>
          <input id="nombre" required />
        </div>

        <div class="col-6">
          <label>Tel√©fono</label>
          <input id="telefono" required pattern="[0-9]{10}" placeholder="10 d√≠gitos" />
        </div>

        <div class="col-6">
          <label>Fecha disponible</label>
          <input id="fecha" type="date" required />
        </div>

        <div class="col-6">
          <label>Hora disponible</label>
          <select id="hora" required>
            <option value="">Selecciona una fecha primero</option>
          </select>
          <small id="horaHelp" style="color:#5b6b86"></small>
        </div>

        <div class="col-12">
          <label>Domicilio actual</label>
          <textarea id="domicilioActual" rows="3" required></textarea>
        </div>

        <div class="col-12">
          <label>Nuevo domicilio</label>
          <textarea id="domicilioNuevo" rows="3" required></textarea>
        </div>

        <div class="col-12">
          <label>Comentarios</label>
          <textarea id="comentarios" rows="3"></textarea>
        </div>

        <div class="col-12">
          <button class="btn btn-primary" type="submit">üì® Enviar solicitud</button>
        </div>

      </form>

      <div id="toast" class="toast"></div>

      <div class="footer">
        <span>¬© <span id="year"></span> Airconekta</span>
        <span>Hecho con ‚ù§Ô∏è</span>
      </div>
    </section>

    <!-- ===== VIEW: WHOAMI (hash route) ===== -->
    <section class="card" data-view="whoami" id="viewWhoami" aria-label="Whoami">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div>
          <h1 style="margin:0 0 4px">Whoami</h1>
          <p class="status" style="margin:0">Vista especial (solo con <strong>#whoami</strong>).</p>
        </div>
        <button class="btn" type="button" id="whoBackBtn">‚Üê Volver</button>
      </div>

      <div class="who-wrap">
        <div class="who-card">
          <div class="who-hero">
            <div class="who-avatar" aria-hidden="true">JE</div>
            <div>
              <p class="who-name" id="whoName">Jair Elizondo</p>
              <p class="who-role" id="whoRole">Soporte / Instalaciones ¬∑ Airconekta</p>
            </div>
            <span class="pill">üß© Debug route ¬∑ #whoami</span>
          </div>

          <div class="divider"></div>

          <div style="display:grid;grid-template-columns:repeat(12,1fr);gap:10px">
            <div style="grid-column:span 6;border:1px solid var(--border);border-radius:16px;padding:12px;background:#fff">
              <strong>üìû Tel√©fono</strong><br>
              <span class="status" id="whoPhonePretty">322 243 9782</span>
            </div>
            <div style="grid-column:span 6;border:1px solid var(--border);border-radius:16px;padding:12px;background:#fff">
              <strong>üü¢ WhatsApp</strong><br>
              <span class="status">Toca ‚ÄúAbrir chat‚Äù para escribir directo</span>
            </div>
            <div style="grid-column:span 6;border:1px solid var(--border);border-radius:16px;padding:12px;background:#fff">
              <strong>üß† Tip</strong><br>
              <span class="status">En consola tambi√©n aparece tu firma</span>
            </div>
            <div style="grid-column:span 6;border:1px solid var(--border);border-radius:16px;padding:12px;background:#fff">
              <strong>üîí Nota</strong><br>
              <span class="status">No aparece en el formulario normal, solo aqu√≠</span>
            </div>
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
            <a class="btn btn-primary" id="whoWhatsBtn" href="#" rel="noopener noreferrer">üü¢ Abrir chat</a>
            <a class="btn" id="whoCallBtn" href="#">üìû Llamar</a>
            <button class="btn" type="button" id="whoCopyBtn">üìã Copiar datos</button>
          </div>

          <div class="divider"></div>

          <div style="border:1px dashed rgba(207,224,255,.9);border-radius:16px;padding:12px;color:var(--muted)">
            Si llegaste aqu√≠ por accidente: vuelve o borra el hash (<strong>#whoami</strong>) de la URL.
          </div>
        </div>

        <div class="who-card">
          <h2 style="margin:0 0 8px">üîé ¬øC√≥mo s√© que s√≠ funciona?</h2>
          <div style="border:1px dashed rgba(207,224,255,.9);border-radius:16px;padding:12px;color:var(--muted)">
            <strong>1)</strong> Abre DevTools ‚Üí Console y recarga: ver√°s tu firma.<br><br>
            <strong>2)</strong> Ctrl+U (Ver c√≥digo fuente): ver√°s el bloque de firma en comentarios.<br><br>
            <strong>3)</strong> Escribe <strong>#whoami</strong> al final de la URL: te trae a esta vista.
          </div>
        </div>
      </div>

      <div class="footer">
        <span>¬© <span class="year"></span> Airconekta</span>
        <span>Debug view ¬∑ #whoami</span>
      </div>
    </section>

  </div>

<script>
const $ = s => document.querySelector(s);
const toast = m => {
  const t = $('#toast');
  t.textContent = m;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),1500);
};

// =====================
// CONFIG FIRMA / WHOAMI
// =====================
const WHOAMI = {
  name: "Jair Elizondo",
  phonePretty: "322 243 9782",
  phoneDigits: "3222439782",
  role: "Soporte / Instalaciones ¬∑ Airconekta",
  hint: "#whoami",
  webHint: "Escribe #whoami al final de la URL"
};

// Firma en consola (solo al depurar)
(function consoleSignature(){
  try{
    const line = "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ";
    console.log("%c" + line, "color:#18c6ff;font-weight:900");
    console.log("%cAIRCONEKTA ¬∑ Firma de desarrollo","color:#246bff;font-size:14px;font-weight:900");
    console.log("%c" + WHOAMI.name + "  ¬∑  " + WHOAMI.phonePretty + "  ¬∑  " + WHOAMI.hint, "color:#7c3aed;font-size:12px;font-weight:900");
    console.log("%c" + WHOAMI.webHint, "color:#5b6b86;font-size:12px;font-weight:800");
    console.log("%c" + line, "color:#18c6ff;font-weight:900");
  }catch{}
})();

// =====================
// Splash (3s)
// =====================
const splash = document.getElementById("splash");
const hideSplash = () => splash?.classList.add("hide");
splash?.addEventListener("click", hideSplash, { passive: true });
window.addEventListener("load", () => { setTimeout(hideSplash, 3000); });

// =====================
// Vistas (form / whoami)
// =====================
const VIEW_KEY = "airconekta_last_view_cambio";
function showView(name){
  document.querySelectorAll("[data-view]").forEach(v => v.classList.remove("active"));
  const view = document.querySelector(`[data-view="${name}"]`);
  if (view) view.classList.add("active");
  if (name !== "whoami") sessionStorage.setItem(VIEW_KEY, name);
  try { window.scrollTo({ top: 0, behavior: "smooth" }); } catch { window.scrollTo(0,0); }
}
function renderWhoami(){
  $("#whoName").textContent = WHOAMI.name;
  $("#whoRole").textContent = WHOAMI.role;
  $("#whoPhonePretty").textContent = WHOAMI.phonePretty;

  const waLink =
    `https://api.whatsapp.com/send?phone=52${WHOAMI.phoneDigits}` +
    `&text=${encodeURIComponent("Hola üëã " + WHOAMI.name + ", necesito soporte / info de Airconekta.")}` +
    `&type=phone_number&app_absent=0`;

  $("#whoWhatsBtn").setAttribute("href", waLink);
  $("#whoCallBtn").setAttribute("href", `tel:+52${WHOAMI.phoneDigits}`);

  $("#whoCopyBtn").onclick = async () => {
    const text =
      `${WHOAMI.name}\n` +
      `${WHOAMI.phonePretty}\n` +
      `Airconekta\n` +
      `Tip: ${location.origin + location.pathname}#whoami`;
    try{
      await navigator.clipboard.writeText(text);
      toast("Datos copiados ‚úÖ");
    }catch{
      toast("No se pudo copiar (permiso del navegador)");
    }
  };

  $("#whoBackBtn").onclick = () => {
    history.replaceState(null, "", location.pathname + location.search);
    const last = sessionStorage.getItem(VIEW_KEY) || "form";
    showView(last);
    toast("Regresando ‚úÖ");
  };
}
function handleHashRoute(){
  const h = (location.hash || "").toLowerCase().trim();
  if (h === "#whoami"){
    renderWhoami();
    showView("whoami");
    return;
  }
  const last = sessionStorage.getItem(VIEW_KEY) || "form";
  showView(last);
}
window.addEventListener("hashchange", handleHashRoute, { passive: true });

window.addEventListener('DOMContentLoaded', () => {

  $('#year').textContent = new Date().getFullYear();
  document.querySelectorAll(".year").forEach(el => el.textContent = new Date().getFullYear());
  if (!sessionStorage.getItem(VIEW_KEY)) sessionStorage.setItem(VIEW_KEY, "form");
  handleHashRoute();

  const NUM = "5213222108817";

  const API = "https://script.google.com/macros/s/AKfycbzy0kbhZmaqwwgOIWYFeRhJkgAZukeq23SNKqhcPnPoB1DiwXmQ9NypiRbEXtpr-45l/exec";

  async function cargarHoras() {
    const f = $('#fecha').value;
    const hora = $('#hora');
    const help = $('#horaHelp');

    if (!f) {
      hora.innerHTML = '<option value="">Selecciona una fecha primero</option>';
      help.textContent = '';
      return;
    }

    hora.innerHTML = '<option value="">Cargando‚Ä¶</option>';
    help.textContent = '';

    try {
      const res = await fetch(`${API}?date=${encodeURIComponent(f)}`);
      const data = await res.json();

      const slots = data.slots || [];
      if (!slots.length) {
        hora.innerHTML = '<option value="">Sin horarios disponibles</option>';
        help.textContent = 'No hay horarios disponibles.';
        return;
      }

      hora.innerHTML = '<option value="">Selecciona una hora</option>';
      slots.forEach(h => {
        const opt = document.createElement('option');
        opt.value = h;
        opt.textContent = h;
        hora.appendChild(opt);
      });

      // Respeta espacios/estructura del tip (no movemos tu small ni lo remaquetamos)
      help.textContent = "Horarios entre 10:00 y 17:00 (sin 14:00).";

    } catch (e) {
      hora.innerHTML = '<option value="">Error al cargar</option>';
      help.textContent = "No se pudo consultar.";
    }
  }

  $('#fecha').addEventListener('change', cargarHoras);

  $('#form').addEventListener('submit', e => {
    e.preventDefault();

    const tel = $('#telefono').value.replace(/\D/g,'');
    if (tel.length !== 10) {
      toast("El tel√©fono debe tener 10 d√≠gitos");
      return;
    }

    const msg =
`Hola üëã
Quiero solicitar un *cambio de domicilio*.

*Nombre:* ${$('#nombre').value}
*Tel√©fono:* ${$('#telefono').value}
*Fecha:* ${$('#fecha').value}
*Hora:* ${$('#hora').value}
*Domicilio actual:*
${$('#domicilioActual').value}

*Nuevo domicilio:*
${$('#domicilioNuevo').value}

*Comentarios:*
${$('#comentarios').value}`;

    window.open(`https://api.whatsapp.com/send?phone=${NUM}&text=${encodeURIComponent(msg)}`);
    toast("Abriendo WhatsApp‚Ä¶");
  });
});
</script>

</body>
</html>
