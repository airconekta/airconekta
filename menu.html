<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Airconekta ¬∑ Centro de Solicitudes</title>
  <meta name="theme-color" content="#ffffff" />
  <meta name="color-scheme" content="light">
  <meta name="description" content="Centro de solicitudes Airconekta: Instalaci√≥n, Cambio de domicilio y Cancelaci√≥n. Env√≠o por WhatsApp con formato listo." />
  <meta name="format-detection" content="telephone=no">
  <meta name="robots" content="index,follow">

  <!-- Open Graph (mejor preview al compartir) -->
  <meta property="og:title" content="Airconekta ¬∑ Centro de Solicitudes">
  <meta property="og:description" content="Instalaci√≥n, Cambio y Cancelaci√≥n. Env√≠a por WhatsApp en 1 minuto.">
  <meta property="og:type" content="website">

  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 256 256'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' x2='1'%3E%3Cstop offset='0' stop-color='%23246bff'/%3E%3Cstop offset='1' stop-color='%230b4ddb'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='256' height='256' rx='56' fill='%23ffffff'/%3E%3Cpath fill='url(%23g)' d='M146 30c-22 8-35 25-40 50-3 15-3 30-10 44-6 12-16 22-30 28-12 5-25 7-36 14-17 10-26 27-26 49 0 33 23 51 56 51 16 0 28-3 41-12 12-8 21-18 28-30 18-29 25-63 17-96 14 8 23 18 27 31 4 12 5 25 3 39-2 14-6 28-6 42 0 28 17 46 46 46 31 0 50-20 50-54 0-43-21-77-56-103-11-8-23-15-33-23-10-9-18-20-21-36-2-12-1-25-6-40-5-14-16-25-34-30z'/%3E%3C/svg%3E" />

  <!-- Tipograf√≠a sistema (r√°pida) + est√©tica 2026 -->
  <style>
    :root{
      --bg:#0b1020;
      --bg2:#0a1633;
      --card:rgba(255,255,255,.86);
      --card2:rgba(255,255,255,.72);
      --ink:#0f1a2e;
      --muted:#5b6b86;

      --accent:#246bff;
      --accent-2:#0b4ddb;
      --accent-3:#6d5efc;

      --border:rgba(140,170,255,.35);
      --ok:#16a34a;
      --warn:#b45309;

      --radius:18px;
      --radius2:22px;

      --shadow:0 18px 50px rgba(0,0,0,.22);
      --shadow2:0 14px 32px rgba(16,48,96,.16);

      --focus:0 0 0 4px rgba(36,107,255,.18);
      --max:1040px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      color:#0b1220;
      background:
        radial-gradient(1200px 800px at 15% 10%, rgba(36,107,255,.32), transparent 55%),
        radial-gradient(1100px 700px at 85% 0%, rgba(109,94,252,.22), transparent 55%),
        radial-gradient(900px 600px at 50% 100%, rgba(11,77,219,.20), transparent 60%),
        linear-gradient(180deg, var(--bg), var(--bg2));
      overflow-x:hidden;
    }

    /* contenedor */
    .shell{ max-width:var(--max); margin:0 auto; padding:22px; }

    /* ‚Äúglass‚Äù moderno */
    .glass{
      background:linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.70));
      border:1px solid var(--border);
      box-shadow:var(--shadow);
      backdrop-filter: blur(14px) saturate(125%);
      -webkit-backdrop-filter: blur(14px) saturate(125%);
    }

    /* top nav */
    .nav{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 16px;
      border-radius:var(--radius2);
      position:sticky; top:12px;
      z-index:10;
    }

    .brand{
      display:flex; gap:12px; align-items:center;
      font-weight:1000;
      letter-spacing:.2px;
      color:#0b1220;
      min-width: 220px;
    }
    .logo{
      width:40px; height:40px; border-radius:14px;
      display:grid; place-items:center;
      background:linear-gradient(135deg, rgba(36,107,255,.14), rgba(109,94,252,.10));
      border:1px solid rgba(36,107,255,.25);
      color:var(--accent-2);
      box-shadow:0 10px 24px rgba(36,107,255,.10);
    }
    .logo span{ font-size:18px; }
    .brand small{
      display:block;
      font-weight:800;
      color:rgba(15,26,46,.72);
      margin-top:2px;
      letter-spacing:0;
    }

    .inline{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:flex-end; }

    /* Card principal */
    .card{
      margin-top:16px;
      padding:20px;
      border-radius:26px;
    }

    /* Tipograf√≠a */
    h1{ font-size:1.55rem; margin:0 0 6px; letter-spacing:-.2px; }
    h2{ font-size:1.12rem; margin:0 0 10px; letter-spacing:-.15px; }
    .lead{ color:rgba(15,26,46,.72); margin:0 0 14px; }

    /* Botones */
    .btn{
      appearance:none;
      cursor:pointer;
      user-select:none;
      border:1px solid rgba(36,107,255,.35);
      color:#0b1220;
      background:rgba(255,255,255,.70);
      padding:12px 14px;
      border-radius:14px;
      font-weight:900;
      letter-spacing:.2px;
      transition: transform .08s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
      line-height:1;
      box-shadow:0 10px 22px rgba(0,0,0,.08);
    }
    .btn:hover{
      border-color:rgba(36,107,255,.55);
      box-shadow:0 0 0 4px rgba(36,107,255,.12), 0 14px 28px rgba(0,0,0,.10);
      transform: translateY(-1px);
    }
    .btn:active{ transform:translateY(0); }

    .btn-primary{
      background:linear-gradient(135deg, var(--accent), var(--accent-2));
      color:#fff;
      border-color:rgba(255,255,255,.22);
      box-shadow:0 16px 34px rgba(36,107,255,.22);
    }
    .btn-primary:hover{
      box-shadow:0 0 0 4px rgba(36,107,255,.18), 0 18px 42px rgba(36,107,255,.24);
      border-color:rgba(255,255,255,.28);
    }

    .btn-ghost{
      background:rgba(255,255,255,.55);
      border-color:rgba(140,170,255,.35);
    }

    .status{ font-size:.92rem; color:rgba(15,26,46,.70); }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      font-size:.9rem;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(140,170,255,.40);
      background:rgba(255,255,255,.62);
      color:rgba(15,26,46,.72);
      font-weight:800;
      white-space:nowrap;
    }

    /* Layout */
    .grid{
      display:grid;
      grid-template-columns:repeat(12,1fr);
      gap:12px;
    }
    .col-12{ grid-column:span 12; }
    .col-6{ grid-column:span 6; }
    .col-4{ grid-column:span 4; }
    @media (max-width:860px){
      .col-6,.col-4{ grid-column:span 12; }
      .shell{ padding:14px; }
      .brand{ min-width:unset; }
    }

    /* Inputs */
    label{ display:block; font-size:.92rem; color:rgba(15,26,46,.72); margin:6px 0 6px; font-weight:800; }
    input,select,textarea{
      width:100%;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(140,170,255,.38);
      background:rgba(255,255,255,.78);
      color:#0b1220;
      outline:none;
      transition:border .15s ease, box-shadow .15s ease, transform .06s ease, background .15s ease;
      font:inherit;
      resize:vertical;
    }
    input:focus,select:focus,textarea:focus{
      border-color:rgba(36,107,255,.65);
      box-shadow:var(--focus);
      background:rgba(255,255,255,.90);
    }
    input:active,select:active,textarea:active{ transform:translateY(.5px); }

    .divider{ height:1px; background:rgba(207,224,255,.7); margin:14px 0; }

    /* selector de vistas (m√°s claro para el usuario) */
    .segmented{
      display:flex; gap:8px; flex-wrap:wrap;
      margin-top:14px;
    }
    .segmented .seg{
      border-radius:999px;
      padding:10px 12px;
      border:1px solid rgba(140,170,255,.38);
      background:rgba(255,255,255,.56);
      font-weight:900;
      cursor:pointer;
      transition:.18s ease;
      display:inline-flex; align-items:center; gap:8px;
    }
    .segmented .seg[aria-pressed="true"]{
      background:linear-gradient(135deg, rgba(36,107,255,.20), rgba(109,94,252,.14));
      border-color:rgba(36,107,255,.45);
      box-shadow:0 0 0 4px rgba(36,107,255,.10);
    }

    /* Cards opciones (home) */
    .option-cards{
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap:12px;
      margin-top:12px;
    }
    @media (max-width:860px){
      .option-cards{ grid-template-columns:1fr; }
    }
    .opt{
      border:1px solid rgba(140,170,255,.38);
      border-radius:20px;
      padding:14px;
      background:rgba(255,255,255,.66);
      box-shadow:0 14px 28px rgba(0,0,0,.08);
      cursor:pointer;
      text-align:left;
      transition:transform .08s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
      position:relative;
      overflow:hidden;
    }
    .opt::after{
      content:"";
      position:absolute; inset:-2px;
      background:radial-gradient(500px 220px at 20% 0%, rgba(36,107,255,.18), transparent 55%);
      opacity:.7;
      pointer-events:none;
    }
    .opt:hover{
      box-shadow:0 18px 40px rgba(0,0,0,.10);
      border-color:rgba(36,107,255,.55);
      transform: translateY(-1px);
      background:rgba(255,255,255,.76);
    }
    .opt:active{ transform:translateY(0); }
    .opt .title{ font-weight:1000; font-size:1.06rem; margin:0; color:#0b1220; position:relative; }
    .opt .desc{ margin:6px 0 0; color:rgba(15,26,46,.72); font-size:.95rem; position:relative; }

    /* Info comercial */
    .info{
      margin-top:14px;
      border:1px solid rgba(140,170,255,.38);
      border-radius:22px;
      padding:14px;
      background:rgba(255,255,255,.62);
      box-shadow:0 12px 26px rgba(0,0,0,.06);
    }
    .info .headline{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      margin-bottom:8px;
    }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(22,163,74,.28);
      background:rgba(22,163,74,.10);
      color:#0f5132;
      font-weight:1000;
      font-size:.92rem;
    }
    .mini-note{
      border:1px dashed rgba(140,170,255,.55);
      background:rgba(247,251,255,.75);
      border-radius:18px;
      padding:12px;
      color:rgba(15,26,46,.72);
      font-size:.95rem;
    }

    .kpoints{
      display:grid;
      grid-template-columns:repeat(12,1fr);
      gap:10px;
      margin-top:10px;
    }
    .k{
      grid-column:span 6;
      border:1px solid rgba(207,224,255,.85);
      border-radius:18px;
      padding:12px;
      background:rgba(255,255,255,.72);
    }
    .k strong{ display:block; margin-bottom:4px; font-weight:1000; }
    @media (max-width:860px){ .k{ grid-column:span 12; } }

    .plans{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:10px;
      margin-top:8px;
    }
    @media (max-width:860px){ .plans{ grid-template-columns:1fr; } }
    .plan{
      border:1px solid rgba(207,224,255,.85);
      border-radius:18px;
      padding:12px;
      background:rgba(255,255,255,.72);
    }
    .plan .pname{ font-weight:1000; margin:0; }
    .plan .pdesc{ margin:6px 0 0; color:rgba(15,26,46,.72); }
    .plan .price{ margin-top:8px; font-weight:1100; color:var(--accent-2); font-size:1.1rem; }

    /* Toast */
    .toast{
      position:fixed; left:50%; bottom:22px;
      transform:translateX(-50%) translateY(18px);
      opacity:0; pointer-events:none;
      background:rgba(255,255,255,.92);
      color:#0b1220;
      padding:10px 14px;
      border-radius:14px;
      border:1px solid rgba(36,107,255,.45);
      box-shadow:0 16px 36px rgba(0,0,0,.18);
      transition:.18s ease;
      z-index:999;
      max-width:min(92vw, 560px);
      text-align:center;
      font-weight:900;
    }
    .toast.show{ transform:translateX(-50%) translateY(0); opacity:1; }

    /* Footer */
    .footer{
      margin:16px 0 0;
      color:rgba(15,26,46,.70);
      font-size:.9rem;
      display:flex;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
      gap:10px;
    }

    /* Vistas */
    [data-view]{ display:none; }
    [data-view].active{ display:block; }

    .top-actions{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
    }

    /* Accesibilidad: reduce motion */
    @media (prefers-reduced-motion: reduce){
      *{ transition:none !important; scroll-behavior:auto !important; }
      .opt:hover,.btn:hover{ transform:none !important; }
    }

    /* Bloque r√°pido de ayuda */
    .help{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      padding:12px;
      border-radius:18px;
      border:1px solid rgba(140,170,255,.38);
      background:rgba(255,255,255,.62);
      margin-top:12px;
    }
    .help .hint{ color:rgba(15,26,46,.72); font-weight:800; }
    .help .actions{ display:flex; gap:10px; flex-wrap:wrap; }

    /* Campo con bot√≥n limpiar */
    .field{ position:relative; }
    .clear-btn{
      position:absolute; right:10px; top:50%;
      transform:translateY(-50%);
      border:1px solid rgba(140,170,255,.35);
      background:rgba(255,255,255,.72);
      border-radius:999px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:1000;
      color:rgba(15,26,46,.78);
      display:none;
    }
    .clear-btn:hover{ box-shadow:0 0 0 4px rgba(36,107,255,.10); border-color:rgba(36,107,255,.45); }
    .field.has-value .clear-btn{ display:inline-flex; }

    /* B√∫squeda colonia */
    .search-row{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
    }
    .search-row > *{ flex:1; }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      border:1px solid rgba(140,170,255,.38);
      background:rgba(255,255,255,.62);
      font-weight:900;
      color:rgba(15,26,46,.72);
      width:max-content;
    }

    /* Header de secci√≥n */
    .section-title{
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px; flex-wrap:wrap;
      margin-top:6px;
    }
    .section-title .meta{
      display:flex; gap:8px; flex-wrap:wrap; align-items:center;
    }

    /* Mensaje previsualizaci√≥n */
    .preview{
      margin-top:12px;
      border:1px solid rgba(140,170,255,.38);
      border-radius:18px;
      background:rgba(255,255,255,.62);
      padding:12px;
    }
    .preview pre{
      margin:0;
      white-space:pre-wrap;
      word-break:break-word;
      font: 13px/1.4 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      color:rgba(15,26,46,.88);
    }

    /* Banner arriba (opcional) */
    .hero{
      padding:14px;
      border-radius:22px;
      border:1px solid rgba(140,170,255,.35);
      background:linear-gradient(135deg, rgba(255,255,255,.74), rgba(255,255,255,.58));
      box-shadow:0 14px 34px rgba(0,0,0,.08);
      margin-top:14px;
    }
    .hero .row{
      display:flex; justify-content:space-between; align-items:flex-start; gap:10px; flex-wrap:wrap;
    }
    .hero .row strong{ font-weight:1000; }
    .hero .row .right{ display:flex; gap:10px; flex-wrap:wrap; }
  </style>
</head>

<body>
  <div class="shell">

    <!-- NAV -->
    <nav class="nav glass" aria-label="Navegaci√≥n principal">
      <div class="brand" aria-label="Airconekta">
        <div class="logo" aria-hidden="true"><span>‚ö°</span></div>
        <div>
          Airconekta
          <small>Centro de solicitudes</small>
        </div>
      </div>

      <div class="inline">
        <button class="btn btn-ghost" id="menuBtn" type="button" aria-label="Ver opciones">‚ò∞ Ver opciones</button>
        <button id="installBtn" class="btn" style="display:none" type="button">‚ûï Instalar app</button>
        <button class="btn" type="button" id="copyBtn" title="Copiar enlace">üîó Copiar enlace</button>
        <a class="btn" href="#" id="shareBtn" title="Compartir">‚á™ Compartir</a>
      </div>
    </nav>

    <!-- ===== HOME ===== -->
    <section class="card glass active" data-view="home" id="viewHome">
      <div class="top-actions">
        <div>
          <h1>Bienvenidos a Airconekta</h1>
          <p class="lead" style="margin-bottom:0">Elige una opci√≥n y env√≠a tu solicitud por WhatsApp en menos de 1 minuto.</p>
        </div>
        <span class="pill" title="Atenci√≥n directa">üìç Empresa local ¬∑ Atenci√≥n directa</span>
      </div>

      <div class="hero" role="note" aria-label="Informaci√≥n r√°pida">
        <div class="row">
          <div>
            <strong>üïí Horarios y atenci√≥n:</strong>
            <div class="status">Respondemos lo m√°s r√°pido posible. Si tardamos, te contestamos en cuanto estemos disponibles.</div>
          </div>
          <div class="right">
            <span class="chip">‚úÖ Sin contratos forzosos</span>
            <span class="chip">‚úÖ Sin aumentos sorpresa</span>
            <span class="chip">‚úÖ Internet ilimitado</span>
          </div>
        </div>
      </div>

      <!-- Opciones -->
      <div class="option-cards" style="margin-top:14px" role="navigation" aria-label="Opciones">
        <button class="opt" type="button" data-go="instalacion" aria-label="Ir a Instalaci√≥n">
          <p class="title">üõ†Ô∏è Instalaci√≥n</p>
          <p class="desc">Solicita instalaci√≥n nueva y env√≠a tus datos listos.</p>
        </button>

        <button class="opt" type="button" data-go="cambio" aria-label="Ir a Cambio de domicilio">
          <p class="title">üè† Cambio de Domicilio</p>
          <p class="desc">Agenda fecha y hora para mover tu servicio.</p>
        </button>

        <button class="opt" type="button" data-go="cancelacion" aria-label="Ir a Cancelaci√≥n">
          <p class="title">üßæ Cancelaci√≥n</p>
          <p class="desc">Solicita cancelaci√≥n y agenda visita de retiro.</p>
        </button>
      </div>

      <!-- Info comercial -->
      <div class="info" aria-label="Puntos clave Airconekta">
        <div class="headline">
          <div class="badge">üí∏ Refiere y gana $100</div>
          <div class="status">Por cada amigo que recomiendes y contrate</div>
        </div>

        <div class="mini-note">
          üåê <strong>AIRCONEKTA</strong> ‚Äî Internet para tu hogar. <strong>Empresa 100% local</strong>, atenci√≥n directa y <strong>sin letras chiquitas</strong>.
        </div>

        <div class="divider"></div>

        <h2 style="margin:0 0 8px">üì∂ Planes y precios (claros y sin sorpresas)</h2>
        <div class="plans">
          <div class="plan">
            <p class="pname">Hasta 15 Mb</p>
            <p class="pdesc">Ideal para hogar y uso diario.</p>
            <div class="price">$300 MXN</div>
          </div>
          <div class="plan">
            <p class="pname">Hasta 20 Mb</p>
            <p class="pdesc">M√°s velocidad para varios equipos.</p>
            <div class="price">$400 MXN</div>
          </div>
          <div class="plan">
            <p class="pname">Hasta 25 Mb</p>
            <p class="pdesc">Para quienes quieren extra rendimiento.</p>
            <div class="price">$600 MXN</div>
          </div>
        </div>

        <div class="divider"></div>

        <h2 style="margin:0 0 8px">üéÅ Beneficios reales</h2>
        <div class="kpoints">
          <div class="k"><strong>‚úÖ Primer mes GRATIS</strong><span class="status">Empieza a usar el servicio desde el primer d√≠a.</span></div>
          <div class="k"><strong>‚úÖ SIN contratos forzosos</strong><span class="status">Te quedas porque te gusta el servicio.</span></div>
          <div class="k"><strong>‚úÖ SIN aumentos inesperados</strong><span class="status">Pagas siempre lo mismo, sin sorpresas.</span></div>
          <div class="k"><strong>‚úÖ Internet ILIMITADO</strong><span class="status">Disfruta sin preocuparte por ‚Äútopes‚Äù.</span></div>
          <div class="k"><strong>‚úÖ Soporte t√©cnico local</strong><span class="status">R√°pido, confiable y de frente.</span></div>
          <div class="k"><strong>üîß Instalaci√≥n: $999 MXN</strong><span class="status">Pago √∫nico (una sola vez).</span></div>
        </div>

        <div class="divider"></div>

        <div class="mini-note">
          ü§ù <strong>Somos empresa local, no call center:</strong>
          te atendemos directo, r√°pido y de frente.
        </div>
      </div>

      <div class="help" aria-label="Ayuda r√°pida">
        <div class="hint">Tip: si ya tienes datos guardados, se autollenan en tu pr√≥xima visita ‚úÖ</div>
        <div class="actions">
          <button class="btn" type="button" id="saveDraftBtn">üíæ Guardar mis datos</button>
          <button class="btn btn-ghost" type="button" id="clearAllBtn">üßπ Borrar todo</button>
        </div>
      </div>

      <div class="footer">
        <span>¬© <span id="year"></span> Airconekta</span>
        <span style="opacity:.85">Hecho con ‚ù§Ô∏è para clientes felices</span>
      </div>
    </section>

    <!-- ===== INSTALACI√ìN ===== -->
    <section class="card glass" data-view="instalacion" id="viewInstalacion">
      <div class="top-actions">
        <div class="section-title">
          <div>
            <h1>Solicitar instalaci√≥n</h1>
            <p class="lead">Completa tus datos. La ubicaci√≥n es <strong>opcional</strong>. Al final se abrir√° WhatsApp con tu informaci√≥n formateada.</p>
          </div>
          <div class="meta">
            <span class="pill">üîí Tus datos solo se usan para generar el mensaje</span>
          </div>
        </div>
        <button class="btn btn-ghost" type="button" data-back>‚Üê Volver</button>
      </div>

      <form id="formInstalacion" class="grid" novalidate>
        <input type="hidden" id="i_colonia" name="colonia" />

        <div class="col-12">
          <label for="i_coloniaSearch">Colonia (opcional) ‚Äî busca r√°pido</label>
          <div class="search-row">
            <div class="field">
              <input id="i_coloniaSearch" placeholder="Escribe para filtrar... (ej. Valle, Zafiro)" autocomplete="off" />
              <button class="clear-btn" type="button" id="i_clearColonia" aria-label="Limpiar b√∫squeda">‚úï</button>
            </div>
            <select id="i_coloniaSelect" name="coloniaSelect" aria-label="Selecciona colonia">
              <option value="" selected>Selecciona una colonia‚Ä¶</option>
              <option>‚öíÔ∏è El Canton, JAL</option>
              <option>‚öíÔ∏è Fracc. Ex Haciendas San Angel, NAY</option>
              <option>‚öíÔ∏è Fracc. La Joya / Los Mangos, NAY</option>
              <option>‚öíÔ∏è Fracc. La Mision, NAY</option>
              <option>‚öíÔ∏è Fracc. Jardin De Las Arboledas, NAY</option>
              <option>‚öíÔ∏è Fracc. Los Anhelos, NAY</option>
              <option>‚öíÔ∏è Fracc. Palma Real, NAY</option>
              <option>‚öíÔ∏è Fracc. Parque Central, NAY</option>
              <option>‚öíÔ∏è Fracc. Primavera Residencial, NAY</option>
              <option>‚öíÔ∏è Fracc. Valle Dorado, NAY</option>
              <option>‚öíÔ∏è Fracc. Valle Esmeralda, NAY</option>
              <option>‚öíÔ∏è Fracc. Valle Marlin, NAY</option>
              <option>‚öíÔ∏è Fracc. Zafiro Residencial, NAY</option>
            </select>
          </div>
          <div class="status" id="i_coloniaStatus" style="margin-top:6px">Sin colonia seleccionada</div>
        </div>

        <div class="col-6">
          <label for="i_nombre">Nombre completo</label>
          <input id="i_nombre" name="nombre" placeholder="Tu nombre" required autocomplete="name" />
        </div>

        <div class="col-6">
          <label for="i_telefono">Tel√©fono</label>
          <input id="i_telefono" name="telefono" inputmode="numeric" autocomplete="tel"
                 placeholder="10 d√≠gitos" pattern="[0-9]{10}"
                 title="Debe contener exactamente 10 d√≠gitos (solo n√∫meros 0-9)" required />
        </div>

        <div class="col-12">
          <label for="i_direccion">Direcci√≥n (calle y n√∫mero)</label>
          <input id="i_direccion" name="direccion" placeholder="Ej: Calle Ju√°rez 123" required autocomplete="street-address" />
        </div>

        <div class="col-6">
          <label for="i_correo">Correo</label>
          <input id="i_correo" name="correo" type="email" placeholder="correo@ejemplo.com" required autocomplete="email" />
        </div>

        <div class="col-6">
          <label for="i_metodo">¬øC√≥mo te enteraste?</label>
          <select id="i_metodo" name="metodo" required>
            <option value="" disabled selected>Selecciona una opci√≥n</option>
            <option>Internet</option>
            <option>Volantes</option>
            <option>Recomendaci√≥n</option>
          </select>
        </div>

        <div class="col-6">
          <label for="i_plan">Plan deseado</label>
          <select id="i_plan" name="plan" required>
            <option value="" disabled selected>Selecciona un plan</option>
            <option value="Plan 300 ‚Äî 15 Mbps">Plan 300 ‚Äî 15 Mbps</option>
            <option value="Plan 400 ‚Äî 20 Mbps">Plan 400 ‚Äî 20 Mbps</option>
            <option value="Plan 600 ‚Äî 25 Mbps">Plan 600 ‚Äî 25 Mbps</option>
          </select>
        </div>

        <div class="col-6">
          <label>Ubicaci√≥n (GPS)</label>
          <div class="inline">
            <button type="button" class="btn" id="i_geoBtn">üìç Obtener ubicaci√≥n</button>
            <span id="i_geoStatus" class="status">Sin ubicaci√≥n</span>
          </div>
          <input type="hidden" id="i_lat" name="lat" />
          <input type="hidden" id="i_lng" name="lng" />
        </div>

        <div class="col-12">
          <div class="inline" style="justify-content:space-between">
            <button type="button" class="btn btn-ghost" id="i_previewBtn">üëÄ Ver mensaje</button>
            <button type="submit" class="btn btn-primary" id="i_sendBtn">üì® Enviar por WhatsApp</button>
          </div>
          <div class="preview" id="i_preview" style="display:none">
            <div class="status" style="margin-bottom:8px;font-weight:900">Previsualizaci√≥n</div>
            <pre id="i_previewText"></pre>
          </div>
        </div>
      </form>

      <div class="footer">
        <span>¬© <span class="year"></span> Airconekta</span>
        <span style="opacity:.85">Gracias por elegir un servicio local</span>
      </div>
    </section>

    <!-- ===== CAMBIO ===== -->
    <section class="card glass" data-view="cambio" id="viewCambio">
      <div class="top-actions">
        <div>
          <h1>Solicitar cambio de domicilio</h1>
          <p class="lead">Agenda fecha y hora. Al finalizar se abrir√° WhatsApp con tu informaci√≥n lista para enviar.</p>
        </div>
        <button class="btn btn-ghost" type="button" data-back>‚Üê Volver</button>
      </div>

      <form id="formCambio" class="grid" novalidate>
        <div class="col-12">
          <label for="c_nombre">Nombre completo</label>
          <input id="c_nombre" name="nombre" placeholder="Tu nombre" required autocomplete="name" />
        </div>

        <div class="col-6">
          <label for="c_telefono">Tel√©fono de contacto</label>
          <input id="c_telefono" name="telefono" inputmode="numeric" autocomplete="tel"
                 placeholder="10 d√≠gitos" pattern="[0-9]{10}"
                 title="Debe contener exactamente 10 d√≠gitos (solo n√∫meros 0-9)" required />
        </div>

        <div class="col-6">
          <label for="c_fecha">Fecha en la que nos puede recibir</label>
          <input id="c_fecha" name="fecha" type="date" required />
        </div>

        <div class="col-6">
          <label for="c_hora">Hora en la que nos puede recibir</label>
          <input id="c_hora" name="hora" type="time" required />
          <div class="status" style="margin-top:6px">Sugerencia: elige una hora en la que est√©s seguro de poder recibirnos.</div>
        </div>

        <div class="col-12">
          <label for="c_domicilioActual">Domicilio actual completo</label>
          <textarea id="c_domicilioActual" name="domicilioActual" rows="3"
                    placeholder="Calle, n√∫mero, colonia, ciudad, CP" required></textarea>
        </div>

        <div class="col-12">
          <label for="c_domicilioNuevo">Nuevo domicilio completo</label>
          <textarea id="c_domicilioNuevo" name="domicilioNuevo" rows="3"
                    placeholder="Calle, n√∫mero, colonia, ciudad, CP" required></textarea>
        </div>

        <div class="col-12">
          <label for="c_comentarios">Comentarios adicionales (opcional)</label>
          <textarea id="c_comentarios" name="comentarios" rows="3"
                    placeholder="Referencias, detalles de acceso, etc. (opcional)"></textarea>
        </div>

        <div class="col-12">
          <div class="inline" style="justify-content:space-between">
            <button type="button" class="btn btn-ghost" id="c_previewBtn">üëÄ Ver mensaje</button>
            <button type="submit" class="btn btn-primary">üì® Enviar por WhatsApp</button>
          </div>
          <div class="preview" id="c_preview" style="display:none">
            <div class="status" style="margin-bottom:8px;font-weight:900">Previsualizaci√≥n</div>
            <pre id="c_previewText"></pre>
          </div>
        </div>
      </form>

      <div class="footer">
        <span>¬© <span class="year"></span> Airconekta</span>
        <span style="opacity:.85">Atenci√≥n local y directa</span>
      </div>
    </section>

    <!-- ===== CANCELACI√ìN ===== -->
    <section class="card glass" data-view="cancelacion" id="viewCancelacion">
      <div class="top-actions">
        <div>
          <h1>Solicitar cancelaci√≥n</h1>
          <p class="lead">Al finalizar se abrir√° WhatsApp con tu informaci√≥n lista para enviar.</p>
        </div>
        <button class="btn btn-ghost" type="button" data-back>‚Üê Volver</button>
      </div>

      <form id="formCancelacion" class="grid" novalidate>
        <div class="col-12">
          <label for="x_nombre">Nombre completo</label>
          <input id="x_nombre" name="nombre" placeholder="Tu nombre" required autocomplete="name" />
        </div>

        <div class="col-6">
          <label for="x_telefono">Tel√©fono de contacto</label>
          <input id="x_telefono" name="telefono" inputmode="numeric" autocomplete="tel"
                 placeholder="10 d√≠gitos" pattern="[0-9]{10}"
                 title="Debe contener exactamente 10 d√≠gitos (solo n√∫meros 0-9)" required />
        </div>

        <div class="col-6">
          <label for="x_fecha">Fecha en la que nos puede recibir</label>
          <input id="x_fecha" name="fecha" type="date" required />
        </div>

        <div class="col-6">
          <label for="x_hora">Hora en la que nos puede recibir</label>
          <input id="x_hora" name="hora" type="time" required />
        </div>

        <div class="col-12">
          <label for="x_domicilio">Domicilio completo del servicio</label>
          <textarea id="x_domicilio" name="domicilio" rows="3"
                    placeholder="Calle, n√∫mero, colonia, ciudad, CP" required></textarea>
        </div>

        <div class="col-12">
          <label for="x_motivo">Motivo de cancelaci√≥n (opcional)</label>
          <textarea id="x_motivo" name="motivo" rows="3"
                    placeholder="Cu√©ntanos brevemente el motivo (opcional)"></textarea>
        </div>

        <div class="col-12">
          <div class="inline" style="justify-content:space-between">
            <button type="button" class="btn btn-ghost" id="x_previewBtn">üëÄ Ver mensaje</button>
            <button type="submit" class="btn btn-primary">üì® Enviar por WhatsApp</button>
          </div>
          <div class="preview" id="x_preview" style="display:none">
            <div class="status" style="margin-bottom:8px;font-weight:900">Previsualizaci√≥n</div>
            <pre id="x_previewText"></pre>
          </div>
        </div>
      </form>

      <div class="footer">
        <span>¬© <span class="year"></span> Airconekta</span>
        <span style="opacity:.85">Gracias por tu tiempo</span>
      </div>
    </section>

  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // =====================
    // CONFIGURACI√ìN
    // =====================
    const NUMERO_DESTINO = "5213222108817";

    // Guarda borradores localmente (no se env√≠an a ning√∫n servidor)
    const LS_KEY = "airconekta_draft_v1";

    const $ = (sel) => document.querySelector(sel);
    const $$ = (sel) => Array.from(document.querySelectorAll(sel));

    const toast = (msg) => {
      const t = $('#toast');
      t.textContent = msg;
      t.classList.add('show');
      clearTimeout(toast._t);
      toast._t = setTimeout(()=>t.classList.remove('show'), 1900);
    };

    // A√±o
    $('#year').textContent = new Date().getFullYear();
    $$('.year').forEach(el => el.textContent = new Date().getFullYear());

    // =====================
    // NAVEGACI√ìN DE VISTAS
    // =====================
    function showView(name){
      $$('[data-view]').forEach(v => v.classList.remove('active'));
      const view = document.querySelector(`[data-view="${name}"]`);
      if (view) view.classList.add('active');
      // scroll instant (evita ‚Äúsaltos‚Äù raros)
      window.scrollTo(0, 0);
      // enfoque amigable
      setTimeout(() => {
        const firstInput = document.querySelector(`[data-view="${name}"] input, [data-view="${name}"] select, [data-view="${name}"] textarea`);
        firstInput?.focus?.();
      }, 60);
      // actualizar hash (para compartir con vista)
      try { history.replaceState(null, "", `#${name}`); } catch {}
    }

    // Bot√≥n men√∫
    $('#menuBtn').addEventListener('click', () => {
      showView('home');
      toast('Opciones listas ‚úÖ');
    });

    // Botones del home
    $$('[data-go]').forEach(btn => {
      btn.addEventListener('click', () => {
        const v = btn.getAttribute('data-go');
        showView(v);
      });
    });

    // Volver
    $$('[data-back]').forEach(b => b.addEventListener('click', () => showView('home')));

    // Carga vista desde hash (si abren enlace #cambio etc.)
    (function(){
      const h = (location.hash || "").replace("#","");
      const allowed = new Set(["home","instalacion","cambio","cancelacion"]);
      if (allowed.has(h)) showView(h);
      else showView('home');
    })();

    // =====================
    // COMPARTIR / COPIAR
    // =====================
    $('#copyBtn').addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(location.href);
        toast('Enlace copiado ‚úÖ');
      } catch {
        toast('No pude copiar. Mant√©n presionado y copia la URL.');
      }
    });

    $('#shareBtn').addEventListener('click', async (e) => {
      e.preventDefault();
      const payload = {
        title: 'Airconekta ¬∑ Centro de Solicitudes',
        text: 'Instalaci√≥n, Cambio y Cancelaci√≥n (WhatsApp listo)',
        url: location.href
      };
      if (navigator.share) {
        try { await navigator.share(payload); }
        catch (_) {}
      } else {
        try {
          await navigator.clipboard?.writeText(location.href);
          toast('Enlace copiado ‚úÖ');
        } catch {
          toast('Copia el enlace desde la barra del navegador');
        }
      }
    });

    // =====================
    // UTILIDADES
    // =====================
    function onlyDigits10(raw){
      const s = (raw || "").replace(/\D+/g,'').slice(0,10);
      return s;
    }

    function validarTelefono10(selector){
      const el = $(selector);
      const digits = onlyDigits10(el.value);
      if (digits.length !== 10) return false;
      return true;
    }

    // Formatea tel√©fono mientras escribe (sin romper pattern)
    function bindPhoneMask(selector){
      const el = $(selector);
      if (!el) return;
      el.addEventListener('input', () => {
        const d = onlyDigits10(el.value);
        el.value = d;
      });
    }
    bindPhoneMask('#i_telefono');
    bindPhoneMask('#c_telefono');
    bindPhoneMask('#x_telefono');

    function abrirWhatsApp(mensaje){
      const url = `https://api.whatsapp.com/send?phone=${NUMERO_DESTINO}&text=${encodeURIComponent(mensaje)}&type=phone_number&app_absent=0`;
      window.open(url, '_blank');
      toast('Abriendo WhatsApp‚Ä¶');
    }

    function formatDateES(iso){
      if (!iso) return '';
      // iso: YYYY-MM-DD
      const [y,m,d] = iso.split('-').map(Number);
      if (!y || !m || !d) return iso;
      const dt = new Date(Date.UTC(y, m-1, d));
      return dt.toLocaleDateString('es-MX', { year:'numeric', month:'long', day:'2-digit' });
    }

    // =====================
    // DRAFT (guardar / cargar)
    // =====================
    function getDraft(){
      try { return JSON.parse(localStorage.getItem(LS_KEY) || "{}"); }
      catch { return {}; }
    }
    function setDraft(obj){
      try { localStorage.setItem(LS_KEY, JSON.stringify(obj || {})); } catch {}
    }

    function fillDraft(){
      const d = getDraft();
      if (!d) return;

      // Instalaci√≥n
      if (d.i_nombre) $('#i_nombre').value = d.i_nombre;
      if (d.i_telefono) $('#i_telefono').value = d.i_telefono;
      if (d.i_direccion) $('#i_direccion').value = d.i_direccion;
      if (d.i_correo) $('#i_correo').value = d.i_correo;
      if (d.i_metodo) $('#i_metodo').value = d.i_metodo;
      if (d.i_plan) $('#i_plan').value = d.i_plan;
      if (d.i_colonia) {
        $('#i_colonia').value = d.i_colonia;
        $('#i_coloniaStatus').textContent = `Colonia: ${d.i_colonia}`;
        // intentar seleccionar en select si coincide
        const sel = $('#i_coloniaSelect');
        const found = Array.from(sel.options).find(o => o.value === d.i_colonia || o.textContent === d.i_colonia);
        if (found) sel.value = found.value;
      }

      // Cambio
      if (d.c_nombre) $('#c_nombre').value = d.c_nombre;
      if (d.c_telefono) $('#c_telefono').value = d.c_telefono;

      // Cancelaci√≥n
      if (d.x_nombre) $('#x_nombre').value = d.x_nombre;
      if (d.x_telefono) $('#x_telefono').value = d.x_telefono;
    }

    function collectDraft(){
      const obj = {
        i_nombre: $('#i_nombre')?.value?.trim() || "",
        i_telefono: $('#i_telefono')?.value?.trim() || "",
        i_direccion: $('#i_direccion')?.value?.trim() || "",
        i_correo: $('#i_correo')?.value?.trim() || "",
        i_metodo: $('#i_metodo')?.value || "",
        i_plan: $('#i_plan')?.value || "",
        i_colonia: ($('#i_colonia')?.value || "").trim(),

        c_nombre: $('#c_nombre')?.value?.trim() || "",
        c_telefono: $('#c_telefono')?.value?.trim() || "",

        x_nombre: $('#x_nombre')?.value?.trim() || "",
        x_telefono: $('#x_telefono')?.value?.trim() || "",
      };
      return obj;
    }

    $('#saveDraftBtn').addEventListener('click', () => {
      setDraft(collectDraft());
      toast('Datos guardados en este dispositivo ‚úÖ');
    });

    $('#clearAllBtn').addEventListener('click', () => {
      // limpia forms + draft
      ['formInstalacion','formCambio','formCancelacion'].forEach(id => {
        const f = document.getElementById(id);
        if (f) f.reset();
      });
      setDraft({});
      // reseteos extras
      setInstalacionColonia('');
      $('#i_geoStatus').textContent = 'Sin ubicaci√≥n';
      $('#i_lat').value = '';
      $('#i_lng').value = '';
      hideAllPreviews();
      toast('Todo borrado ‚úÖ');
    });

    fillDraft();

    // =====================
    // INSTALACI√ìN: colonia + b√∫squeda + geolocalizaci√≥n
    // =====================
    const i_coloniaSelect = $('#i_coloniaSelect');
    const i_coloniaHidden = $('#i_colonia');
    const i_coloniaStatus = $('#i_coloniaStatus');

    function setInstalacionColonia(val){
      i_coloniaHidden.value = val || '';
      i_coloniaStatus.textContent = val ? `Colonia: ${val}` : 'Sin colonia seleccionada';
    }
    i_coloniaSelect.addEventListener('change', () => setInstalacionColonia(i_coloniaSelect.value));

    // filtro de colonias (b√∫squeda)
    const coloniaAll = Array.from(i_coloniaSelect.querySelectorAll('option'))
      .map(o => ({ value:o.value, text:o.textContent }));

    function applyColoniaFilter(q){
      const query = (q || '').trim().toLowerCase();
      // reconstruye options preservando el primero
      i_coloniaSelect.innerHTML = '';
      const first = document.createElement('option');
      first.value = '';
      first.selected = true;
      first.textContent = 'Selecciona una colonia‚Ä¶';
      i_coloniaSelect.appendChild(first);

      coloniaAll.forEach((o, idx) => {
        if (idx === 0) return; // era el placeholder original
        if (!query || (o.text || '').toLowerCase().includes(query)) {
          const opt = document.createElement('option');
          opt.value = o.value;
          opt.textContent = o.text;
          i_coloniaSelect.appendChild(opt);
        }
      });

      // si hab√≠a colonia ya seleccionada, intenta mantenerla
      const current = (i_coloniaHidden.value || '').trim();
      if (current) {
        const match = Array.from(i_coloniaSelect.options).find(x => x.value === current || x.textContent === current);
        if (match) i_coloniaSelect.value = match.value;
      }
    }

    const i_coloniaSearch = $('#i_coloniaSearch');
    const i_clearColonia = $('#i_clearColonia');
    function updateClearBtn(){
      const field = i_coloniaSearch.closest('.field');
      if (!field) return;
      if (i_coloniaSearch.value.trim()) field.classList.add('has-value');
      else field.classList.remove('has-value');
    }
    i_coloniaSearch.addEventListener('input', () => {
      applyColoniaFilter(i_coloniaSearch.value);
      updateClearBtn();
    });
    i_clearColonia.addEventListener('click', () => {
      i_coloniaSearch.value = '';
      applyColoniaFilter('');
      updateClearBtn();
      i_coloniaSearch.focus();
    });
    updateClearBtn();

    // Geolocalizaci√≥n
    $('#i_geoBtn').addEventListener('click', () => {
      const s = $('#i_geoStatus');
      if (!('geolocation' in navigator)) {
        s.textContent = 'Geolocalizaci√≥n no soportada';
        toast('Tu navegador no soporta ubicaci√≥n');
        return;
      }
      s.textContent = 'Obteniendo ubicaci√≥n‚Ä¶';
      navigator.geolocation.getCurrentPosition((pos) => {
        const { latitude, longitude } = pos.coords;
        $('#i_lat').value = latitude.toFixed(6);
        $('#i_lng').value = longitude.toFixed(6);
        s.textContent = `Lat ${$('#i_lat').value}, Lng ${$('#i_lng').value}`;
        toast('Ubicaci√≥n lista ‚úÖ');
      }, (err) => {
        console.warn(err);
        s.textContent = 'No se pudo obtener ubicaci√≥n';
        toast('No se pudo obtener ubicaci√≥n');
      }, { enableHighAccuracy:true, timeout:12000, maximumAge:0 });
    });

    // =====================
    // PREVIEWS
    // =====================
    function hideAllPreviews(){
      ['i_preview','c_preview','x_preview'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.style.display = 'none';
      });
    }

    function buildMsgInstalacion(){
      const form = $('#formInstalacion');
      if (!form.checkValidity()) return null;

      const nombre = $('#i_nombre').value.trim();
      const direccion = $('#i_direccion').value.trim();
      const plan = $('#i_plan').value;
      const tel = $('#i_telefono').value.trim();
      const correo = $('#i_correo').value.trim();
      const metodo = $('#i_metodo').value;
      const colonia = (i_coloniaHidden.value || '').trim();
      const lat = $('#i_lat').value, lng = $('#i_lng').value;

      let msg = `Hola üëã\nMe gustar√≠a hablar sobre la contrataci√≥n del servicio.\n\n`;
      msg += `*Tipo de solicitud:* Instalaci√≥n\n`;
      msg += `*Nombre:* ${nombre}\n`;
      msg += `*Direcci√≥n:* ${direccion}${colonia ? `, ${colonia}` : ''}\n`;
      msg += `*Plan deseado:* ${plan}\n`;
      msg += `*Tel√©fono:* ${tel}\n`;
      msg += `*Correo:* ${correo}\n`;
      msg += `*C√≥mo me enter√©:* ${metodo}\n`;
      if (lat && lng) msg += `*Ubicaci√≥n:* https://www.google.com/maps?q=${lat},${lng}\n`;
      msg += `\nGracias.`;

      return msg;
    }

    function buildMsgCambio(){
      const form = $('#formCambio');
      if (!form.checkValidity()) return null;

      const nombre = $('#c_nombre').value.trim();
      const telefono = $('#c_telefono').value.trim();
      const fecha = $('#c_fecha').value;
      const hora = $('#c_hora').value;
      const domicilioActual = $('#c_domicilioActual').value.trim();
      const domicilioNuevo = $('#c_domicilioNuevo').value.trim();
      const comentarios = $('#c_comentarios').value.trim();

      let msg = `Hola üëã\nMe gustar√≠a solicitar un *cambio de domicilio* de mi servicio.\n\n`;
      msg += `*Tipo de solicitud:* Cambio de domicilio\n`;
      msg += `*Nombre:* ${nombre}\n`;
      msg += `*Tel√©fono de contacto:* ${telefono}\n`;
      msg += `*Domicilio actual:*\n${domicilioActual}\n`;
      msg += `*Nuevo domicilio:*\n${domicilioNuevo}\n`;
      msg += `*Fecha:* ${fecha ? formatDateES(fecha) : 'No especificada'}\n`;
      msg += `*Hora:* ${hora || 'No especificada'}\n`;
      if (comentarios) msg += `*Comentarios:*\n${comentarios}\n`;
      msg += `\nGracias.`;

      return msg;
    }

    function buildMsgCancelacion(){
      const form = $('#formCancelacion');
      if (!form.checkValidity()) return null;

      const nombre = $('#x_nombre').value.trim();
      const telefono = $('#x_telefono').value.trim();
      const fecha = $('#x_fecha').value;
      const hora = $('#x_hora').value;
      const domicilio = $('#x_domicilio').value.trim();
      const motivo = $('#x_motivo').value.trim();

      let msg = `Hola üëã\nMe gustar√≠a solicitar la *cancelaci√≥n* de mi servicio.\n\n`;
      msg += `*Tipo de solicitud:* Cancelaci√≥n\n`;
      msg += `*Nombre:* ${nombre}\n`;
      msg += `*Tel√©fono de contacto:* ${telefono}\n`;
      msg += `*Domicilio del servicio:*\n${domicilio}\n`;
      msg += `*Fecha:* ${fecha ? formatDateES(fecha) : 'No especificada'}\n`;
      msg += `*Hora:* ${hora || 'No especificada'}\n`;
      if (motivo) msg += `*Motivo:*\n${motivo}\n`;
      msg += `\nGracias.`;

      return msg;
    }

    // Botones preview
    $('#i_previewBtn').addEventListener('click', () => {
      const form = $('#formInstalacion');
      if (!form.checkValidity()) { form.reportValidity(); return; }
      if (!validarTelefono10('#i_telefono')) { toast('El tel√©fono debe tener 10 d√≠gitos'); $('#i_telefono').focus(); return; }

      const msg = buildMsgInstalacion();
      $('#i_previewText').textContent = msg || '';
      $('#i_preview').style.display = 'block';
      toast('Vista previa lista ‚úÖ');
    });

    $('#c_previewBtn').addEventListener('click', () => {
      const form = $('#formCambio');
      if (!form.checkValidity()) { form.reportValidity(); return; }
      if (!validarTelefono10('#c_telefono')) { toast('El tel√©fono debe tener 10 d√≠gitos'); $('#c_telefono').focus(); return; }

      const msg = buildMsgCambio();
      $('#c_previewText').textContent = msg || '';
      $('#c_preview').style.display = 'block';
      toast('Vista previa lista ‚úÖ');
    });

    $('#x_previewBtn').addEventListener('click', () => {
      const form = $('#formCancelacion');
      if (!form.checkValidity()) { form.reportValidity(); return; }
      if (!validarTelefono10('#x_telefono')) { toast('El tel√©fono debe tener 10 d√≠gitos'); $('#x_telefono').focus(); return; }

      const msg = buildMsgCancelacion();
      $('#x_previewText').textContent = msg || '';
      $('#x_preview').style.display = 'block';
      toast('Vista previa lista ‚úÖ');
    });

    // =====================
    // SUBMITS
    // =====================
    $('#formInstalacion').addEventListener('submit', (e) => {
      e.preventDefault();
      const form = $('#formInstalacion');
      if (!form.checkValidity()) { form.reportValidity(); return; }
      if (!validarTelefono10('#i_telefono')) { toast('El tel√©fono debe tener 10 d√≠gitos'); $('#i_telefono').focus(); return; }

      const msg = buildMsgInstalacion();
      // autoguardar datos
      setDraft(collectDraft());
      abrirWhatsApp(msg);
    });

    $('#formCambio').addEventListener('submit', (e) => {
      e.preventDefault();
      const form = $('#formCambio');
      if (!form.checkValidity()) { form.reportValidity(); return; }
      if (!validarTelefono10('#c_telefono')) { toast('El tel√©fono debe tener 10 d√≠gitos'); $('#c_telefono').focus(); return; }

      const msg = buildMsgCambio();
      setDraft(collectDraft());
      abrirWhatsApp(msg);
    });

    $('#formCancelacion').addEventListener('submit', (e) => {
      e.preventDefault();
      const form = $('#formCancelacion');
      if (!form.checkValidity()) { form.reportValidity(); return; }
      if (!validarTelefono10('#x_telefono')) { toast('El tel√©fono debe tener 10 d√≠gitos'); $('#x_telefono').focus(); return; }

      const msg = buildMsgCancelacion();
      setDraft(collectDraft());
      abrirWhatsApp(msg);
    });

    // =====================
    // PWA (manifest + SW) simple (sin archivos extra)
    // =====================
    const manifest = {
      name: 'Airconekta Centro de Solicitudes',
      short_name: 'Airconekta',
      description: 'Instalaci√≥n, Cambio de domicilio y Cancelaci√≥n. Env√≠o por WhatsApp.',
      start_url: '.',
      display: 'standalone',
      background_color: '#0b1020',
      theme_color: '#ffffff',
      icons: [
        { src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAQAAACENn8fAAAAI0lEQVQYV2NkYGD4z0AEMGGgAQZGBgYGBhA1FIwJQ3EAAEw4AABf1g4p2n3Y3wAAAABJRU5ErkJggg==', sizes: '48x48', type: 'image/png' },
        { src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAQAAAB8Hs0fAAAAKUlEQVQ4y2NkoBAwUqifAWEGQwYGBgYwQ2oYg0EwGg0Go0GgYHxGAgA8m0g0pAKg5wAAAABJRU5ErkJggg==', sizes: '72x72', type: 'image/png' }
      ]
    };
    const manBlob = new Blob([JSON.stringify(manifest)], { type:'application/json' });
    const manURL = URL.createObjectURL(manBlob);
    const link = document.createElement('link');
    link.rel = 'manifest';
    link.href = manURL;
    document.head.appendChild(link);

    if ('serviceWorker' in navigator) {
      const swCode = `
        const CACHE = 'airconekta-centro-v2';
        self.addEventListener('install', e => {
          e.waitUntil(caches.open(CACHE).then(c => c.addAll([self.registration.scope])));
          self.skipWaiting();
        });
        self.addEventListener('activate', e => { e.waitUntil(self.clients.claim()); });
        self.addEventListener('fetch', e => {
          const req = e.request;
          if (req.method !== 'GET') return;
          e.respondWith(
            caches.match(req).then(r => r || fetch(req).then(res => {
              const copy = res.clone();
              caches.open(CACHE).then(c => c.put(req, copy));
              return res;
            }).catch(() => caches.match(self.registration.scope)))
          );
        });
      `;
      const swBlob = new Blob([swCode], { type:'text/javascript' });
      const swURL = URL.createObjectURL(swBlob);
      navigator.serviceWorker.register(swURL).catch(()=>{});
    }

    // Bot√≥n instalar PWA (si aplica)
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      const btn = document.getElementById('installBtn');
      btn.style.display = 'inline-flex';
      btn.onclick = async () => {
        btn.disabled = true;
        try { await deferredPrompt.prompt(); await deferredPrompt.userChoice; }
        finally { deferredPrompt = null; btn.style.display = 'none'; }
      };
    });
  </script>
</body>
</html>
